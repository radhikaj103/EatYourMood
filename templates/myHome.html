{% extends "layout.html" %}

{% block title %}
    myHome
{% endblock %}

{% block main %}
<h4><div class="float-left">Budget Tracking</div></h4>
<br/>
<table class="table table-striped">
    <tbody>
        <tr> <td>Budget</td> <td></td> <td>{{ "$%.2f"|format(myBudget  | float) }}</td> </tr>
        <tr> <td>Total Expense</td> <td></td> <td>{{ "$%.2f"|format(myExpense | float) }}</td> </tr>
        <tr> <td>Remaining Budget</td> <td></td> <td>{{ "$%.2f"|format(myBudget | float - myExpense | float) }}</td> </tr>
    </tbody>
</table>
<form id = "updateBudget" name = "updateBudget" method = "POST" action="/myHome">
    <input type="hidden" id = "newBudget" name = "newBudget"></input>
</form>
<div class="float-right">
<button type="submit" onclick="showPopup()">Update Budget</button>
</div>


<script>
    function showPopup()
    {
        var newBudgetStr = prompt("Please enter your new budget:", "0");

        if (newBudgetStr == null || newBudgetStr  == "")
        {
            // Nothing to do
        }
        else
        {
            document.getElementById("newBudget").value = parseFloat(newBudgetStr);
            document.getElementById("updateBudget").submit();
        }
    }
</script>

<br/>
<br/>
<hr/>

<h4><div class="float-left">Transactions</div></h4>
<br/>
<table class="table table-striped">
    <thead>
        <th scope="col">Business Name</th>
        <th scope="col">Date</th>
        <th scope="col">Expense</th>
    </thead>
    <tbody>
        {% for expense in expenseRow %}
        <tr>
            <td>{{ expense["businessName"] }}</td>
            <td>{{ expense["purchase_date"] }}</td>
            <td>{{ "$%.2f"|format(expense["expense"] | float) }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<br/>

<hr/>
<h4><div class="float-left">Add a new transaction</div></h4>
<br/>
<br/>
<form id = "newTransaction" name = "newTransaction" method = "POST" action="/myHome">
    <div class="row">
        <div class="col">
            <input type="text" class="form-control" id="businessName" name="businessName" placeholder="Enter business name">
        </div>
        <div class="col">
            <input type="date" class="form-control" id="date" name="date" placeholder="Enter transaction date">
        </div>
        <div class="col">
            <input type="text" class="form-control" id="expense" name="expense" placeholder="Enter expense">
        </div>
        <div class="col">
        <button type="submit" class="btn btn-default">Submit</button>
        </div>
    </div>
</form>

{% endblock %}